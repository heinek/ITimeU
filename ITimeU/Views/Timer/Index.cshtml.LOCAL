@model ITimeU.Models.TimerModel
@{
    ViewBag.Title = "Index";
}
<script src="@Url.Content("~/Scripts/jquery-1.4.4.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/Stopwatch.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/Tools.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/TimeFormatFactory.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/TimerHandler.js")" type="text/javascript"></script>
<script type="text/javascript">
    $(document).ready(function () {
        var btnReset = $("#btnReset");
        var btnStart = $("#btnStart");
        var btnEdit = $("#btnEdit");
        var tbEdit = $("#tbEdit");
        var lblTimer = $("#lblRunningTimer");
        var btnIntermediate = $("#btnIntermediate");
        var listIntermediate = $("#lstIntermediates");
        var btnDelete = $("#btnDelete");
        var ddlCheckpoints = $("#ddlCheckpoints");

        var handler = new TimerHandler();
        handler.initTimer(lblTimer);
        handler.setStartStopActions(
            btnStart,
            function () { $.get("/Timer/Start/"); },
            function () { $.get("/Timer/Stop/"); }
        );

        handler.setResetAction(
            btnReset,
            function () { $.get("/Timer/Reset/"); }
        );

        handler.setIntermediateAction(
            btnIntermediate,
            ddlCheckpoints,
            listIntermediate
        );

        handler.setEditAction(
            listIntermediate,
            btnEdit,
            tbEdit
        );

        handler.setDeleteAction(
            listIntermediate,
            btnDelete
        );

        handler.setChangeAction(
            listIntermediate,
            tbEdit
        );
    });
</script>
<div class="contentmargin">
<div class="containter">
    <div class="row">
        <div class="left">
            <div class="editor-label" style="vertical-align:top">
                @Html.Label("lblCheckpoint", "Passeringspunkt:")
            </div>
        </div>
        <div class="row">
            <div class="editor-field">
                @Html.DropDownList("ddlCheckpoints", new SelectList(ViewBag.Checkpoints, "CheckpointID", "Name"))
            </div>
        </div>
    </div>
    <div class="row">
        <div class="left">
            <span id="lblRunningTimer" class="timer"></span>
        </div>
        <div class="right">
            <input type="button" id="btnStart" value="Start" style="width: 100px" />
            <input type="button" id="btnReset" value="Nullstill" style="width: 100px" />
            <input type="button" id="btnIntermediate" value="Mellomtid" style="width: 100px" />
        </div>
    </div>
    <div class="row">
        <div class="left">
            @Html.ListBox("lstIntermediates", new SelectList(Model.RuntimeDic, "Key", "Value"), new { @class = "listbox" })
        </div>
        <div class="right">
            @Html.TextBox("tbEdit", null, new { @class = "textbox" })
            <br />
            <input type="button" id="btnEdit" value="Endre" style="width: 100px" disabled="disabled" />
            <input type="button" id="btnDelete" value="Slett" style="width: 100px" disabled="disabled" />
        </div>
    </div>
</div>
</div>