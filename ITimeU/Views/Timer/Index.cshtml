@model ITimeU.Models.TimerModel
@{
    ViewBag.Title = "Index";
}
<script src="@Url.Content("~/Scripts/jquery-1.4.4.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/Stopwatch.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/Tools.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/TimeFormatFactory.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/TimerHandler.js")" type="text/javascript"></script>
<script type="text/javascript">
    $(document).ready(function () {
        var btnStartTimer = Tools.selectElementById("btnStartTimer");
        var lblTimer = Tools.selectElementById("lblRunningTimer");
        var btnIntermediate = Tools.selectElementById("btnIntermediate");
        var listIntermediate = Tools.selectElementById("olIntermediates");
        var listIntermediateID = "lstIntermediates"; //must be same as html below
        var listHolder = Tools.selectElementById("listHolder");
        var tbEditID = "tbEdit"; //must be same as html below
        var btnEditID = "btnChange"; //must be same as html below
        var btnDeleteID = "btnDelete";

        var btnEdit = Tools.selectElementById(btnEditID);
        var tbEdit = Tools.selectElementById(tbEditID);
        var btnDelete = Tools.selectElementById(btnDeleteID);

        var handler = new TimerHandler();

        handler.setStartStopActions(
            btnStartTimer,
            function () { alert('starting');  $.get("/Timer/Start/"); }, // Start button clicked
            function () { alert('stopping'); $.get("/Timer/Stop/"); }, // Stop button clicked
            function () { alert('restarting'); $.get("/Timer/Start/"); } // Restart button clicked
        );

        handler.setIntermediateAction(
            btnIntermediate,
            listIntermediate
        );

        handler.setEditAction(
            listIntermediate,
            btnEdit,
            tbEdit
        );

        handler.setDeleteAction(
            listIntermediate,
            btnDelete
        );

        handler.setChangeAction(
            listIntermediate,
            tbEdit
        );

        handler.showTimer(lblTimer);
  });
</script>
<table style="border-style: hidden">
    <tr>
        <td style="border-style: hidden">
            <h3>
                Sjekkpunkt: @ViewData["checkpoint"]</h3>
        </td>
        <td style="border-style: hidden">
            [@Html.ActionLink("Endre", "Index", "Checkpoint")]
        </td>
    </tr>
</table>
<div id="containter">
    <div class="row">
        <div class="left">
            <span id="lblRunningTimer" class="timer"></span>
        </div>
        <div class="right">
            <input type="button" id="btnStartTimer" value="Start" style="width: 100px" />
            <input type="button" id="btnIntermediate" value="Mellomtid" style="width: 100px" />
        </div>
    </div>
    <div class="row">
        <div class="left">
            @Html.ListBox("lstIntermediates", new SelectList(Model.RuntimeDic, "Key", "Value"), new { @class = "listbox" })
        </div>
        <div class="right">
            @Html.TextBox("tbEdit", null, new { @class = "textbox" })
            <br />
            <input type="button" id="btnChange" value="Endre" style="width: 100px" disabled="disabled" />
            <input type="button" id="btnDelete" value="Slett" style="width: 100px" disabled="disabled" />
        </div>
    </div>
</div>
